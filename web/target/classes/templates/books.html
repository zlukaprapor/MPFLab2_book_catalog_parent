<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="#{page.books.title}">–ö–∞—Ç–∞–ª–æ–≥ –∫–Ω–∏–≥</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
<div th:replace="~{fragments/header :: header}"></div>

<div class="container">
    <!-- –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ -->
    <div class="user-info" style="text-align: right; color: white; margin-bottom: 20px;">
        <span sec:authorize="isAuthenticated()">
            üë§ –ü—Ä–∏–≤—ñ—Ç, <strong><span sec:authentication="name"></span></strong>
            (<span sec:authentication="authorities"></span>)
        </span>
        <form th:action="@{/logout}" method="post" style="display: inline; margin-left: 15px;">
            <button type="submit" class="btn-secondary" style="padding: 8px 16px; font-size: 0.9rem;">
                üö™ –í–∏–π—Ç–∏
            </button>
        </form>
    </div>

    <header>
        <h1 th:text="#{page.books.heading}">üìö –ö–∞—Ç–∞–ª–æ–≥ –∫–Ω–∏–≥</h1>
        <p class="subtitle" th:text="#{page.books.subtitle}">–ó–Ω–∞–π–¥—ñ—Ç—å —Ü—ñ–∫–∞–≤—ñ –∫–Ω–∏–≥–∏</p>
    </header>

    <!-- –ö–Ω–æ–ø–∫–∞ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∫–Ω–∏–≥–∏ - —Ç—ñ–ª—å–∫–∏ –¥–ª—è ADMIN -->
    <div class="add-book-section" sec:authorize="hasRole('ADMIN')">
        <a th:href="@{/books/add}" class="btn-add-book" th:text="#{button.add.book}">
            ‚ûï –î–æ–¥–∞—Ç–∏ –∫–Ω–∏–≥—É
        </a>
    </div>

    <div class="search-box">
        <form th:action="@{/books}" method="get" class="search-controls">
            <input type="text" name="q" th:value="${query}"
                   th:placeholder="#{form.search.placeholder}">
            <select name="sort">
                <option value="title" th:selected="${sort == 'title'}"
                        th:text="#{sort.title}">–ó–∞ –Ω–∞–∑–≤–æ—é</option>
                <option value="author" th:selected="${sort == 'author'}"
                        th:text="#{sort.author}">–ó–∞ –∞–≤—Ç–æ—Ä–æ–º</option>
                <option value="year" th:selected="${sort == 'year'}"
                        th:text="#{sort.year}">–ó–∞ —Ä–æ–∫–æ–º</option>
            </select>
            <select name="size">
                <option value="6">6</option>
                <option value="12" selected>12</option>
                <option value="24">24</option>
            </select>
            <input type="hidden" name="page" th:value="${currentPage}">
            <button type="submit" th:text="#{button.search}">üîç –ü–æ—à—É–∫</button>
        </form>

        <div class="pagination" th:if="${bookPage.totalPages > 1}">
            <button th:if="${bookPage.hasPrevious}"
                    th:onclick="|window.location.href='@{/books(page=${currentPage - 1}, size=${bookPage.pageSize}, sort=${sort}, q=${query})}'|"
                    th:text="#{button.previous}">‚Üê –ù–∞–∑–∞–¥</button>

            <span class="page-info"
                  th:text="#{pagination.info(${currentPage + 1}, ${bookPage.totalPages})}">
                    –°—Ç–æ—Ä—ñ–Ω–∫–∞ 1 –∑ 10
                </span>

            <button th:if="${bookPage.hasNext}"
                    th:onclick="|window.location.href='@{/books(page=${currentPage + 1}, size=${bookPage.pageSize}, sort=${sort}, q=${query})}'|"
                    th:text="#{button.next}">–í–ø–µ—Ä–µ–¥ ‚Üí</button>
        </div>
    </div>

    <div th:if="${bookPage.content.isEmpty()}" class="no-results">
        <h3 th:text="#{message.no.books}">üòï –ù–µ–º–∞—î –∫–Ω–∏–≥</h3>
    </div>

    <div th:unless="${bookPage.content.isEmpty()}" class="books-grid">
        <div th:each="book : ${bookPage.content}" class="book-card"
             th:onclick="|window.location.href='@{/books/{id}(id=${book.id})}'|"
             style="cursor: pointer;">
            <div class="book-title" th:text="${book.title}">–ù–∞–∑–≤–∞</div>
            <div class="book-author" th:text="|‚úçÔ∏è ${book.author}|">–ê–≤—Ç–æ—Ä</div>
            <div class="book-details">
                <span th:if="${book.isbn}" th:text="|üìñ ${book.isbn}|">ISBN</span>
                <span th:if="${book.year}" th:text="|üìÖ ${book.year}|">–†—ñ–∫</span>
            </div>
        </div>
    </div>
</div>

<div th:replace="~{fragments/footer :: footer}"></div>
</body>
</html>